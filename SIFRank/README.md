# 中文短文本关键词抽取
使用无监督方法抽取问题中的关键词。代码在[SIFRank](https://github.com/sunyilgdx/SIFRank_zh)
基础上修改。

## 修改部分
1. 改用LTP工具对问题分词和词性标注；
2. elmo改为RoBerta；

## 核心算法
### 预训练模型ELMo+句向量模型SIF
词向量ELMo优势：1）经过大规模预训练，较TFIDF、TextRank等基于统计和图的具有更多的语义信息；2）ELMo是动态的，可以改善一词多义问题；3）ELMo通过Char-CNN编码，对生僻词非常友好；4）不同层的ELMo可以捕捉不同层次的信息

句向量SIF优势：1）根据词频对词向量进行平滑反频率加权，能更好地捕捉句子的中心话题；2）更好地过滤通用词
### 算法流程
1. 对问题分词和词性标注，利用正则表达式确定名词短语（例如：形容词+名词），将名词短语作为候选关键短语；
2. 使用ELMO得到每层每个token的词向量；
3. 从权重文件中获取每个词的权重；
4. 对词向量加权平均得到每层句向量；
5. 取每个候选词的每层词向量并乘以权重；
6. 计算每个候选词与句向量的cos值；
7. 对cos值排序，取前K个为关键词。
## 环境
```
Python 3.6
nltk 3.4.3
elmoformanylangs 0.0.3
ltp 4.1.4
torch 1.8.0
```

## 数据下载

https://github.com/SophonPlus/ChineseNlpCorpus/blob/master/datasets/liantongzhidao/intro.ipynb

## 用法
```
在 test.py 文件中：

text = '数十年来，美国官方对于UFO现象的调查备受瞩目。但是始终没有得出一个是否存在外星人的确切结论。'
extract(text)
```
## 用例展示
> text = "数十年来，美国官方对于UFO现象的调查备受瞩目。但是始终没有得出一个是否存在外星人的确切结论。"
```
关键词         权重
确切结论    0.8754586298217124
外星人 0.8518731149594871
UFO现象   0.8224929498736531
美国官方    0.7967794270642581
```

## 分析
SIFRank采用了动态预训练词向量模型ELMo和句向量模型SIF，用完全无监督的方法进行关键短语（keyphrase）的抽取，相比于jieba的TFIDF和TextRank算法，不仅抽取的关键词更加完整，且由于引入了预训练的知识，关键词之间的关系更为丰富，不再仅限于句子结构本身。

